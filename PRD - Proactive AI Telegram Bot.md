# PRD - Proactive AI Telegram Bot

## 1. 프로젝트 개요

### 1.1 배경
현재 AI 서비스들은 **반응형(Reactive)** - 사용자가 물어봐야 답한다.
이 프로젝트는 **능동형(Proactive)** - AI가 먼저 필요한 정보를 제공한다.

### 1.2 목표
- 시간대별 맞춤 정보 자동 제공
- Telegram을 통한 편리한 소통
- 최소 비용으로 24시간 운영

### 1.3 성공 지표
- 일일 활성 메시지: 5회 이상 (AI→사용자)
- 정보 유용성: 체감 만족도 80%+
- 월 운영 비용: $0 (무료 티어 최대 활용)

---

## 2. 타임라인별 기능 상세

### 2.1 🌅 아침 (기상시간, 기본 07:00)

| 기능 | 상세 | 데이터 소스 |
|------|------|-------------|
| 날씨 브리핑 | 현재 기온, 체감온도, 강수확률 | OpenWeatherMap API / 기상청 |
| 옷차림 추천 | 기온별 추천 (따뜻하게/시원하게) | 날씨 데이터 기반 규칙 |
| 우산 알림 | 강수확률 30% 이상시 알림 | 날씨 데이터 |
| 이미지 생성 | 날씨 컨셉 일러스트 | Flux / DALL-E Mini |

**예시 메시지:**
```
🌤 좋은 아침이에요!

오늘 서울 날씨:
- 현재 5°C (체감 2°C)
- 최고 12°C / 최저 3°C
- 강수확률 10%

👔 추천: 따뜻한 겉옷 필수! 낮에는 조금 풀리니 레이어드 추천
☂️ 우산은 필요 없어요
```

### 2.2 🚇 출근길 (08:00)

| 기능 | 상세 | 데이터 소스 |
|------|------|-------------|
| 뉴스 브리핑 | 관심 분야 3-5개 기사 요약 | 웹 검색 (News API, Google News) |
| 출처 제공 | 원문 링크 포함 | - |
| 카테고리 | AI/Tech, 업계 동향, 일반 | 사용자 설정 |

**예시 메시지:**
```
📰 오늘의 테크 뉴스

1️⃣ [AI] Claude 4.5 출시, 코딩 능력 대폭 향상
   "Anthropic이 최신 모델 공개..."
   🔗 techcrunch.com/...

2️⃣ [Tech] 애플, M5 칩 개발 본격화
   "2026년 출시 목표로..."
   🔗 macrumors.com/...

3️⃣ [Industry] 에듀테크 시장 2025년 전망
   "AI 기반 학습의 성장..."
   🔗 edtechreview.com/...
```

### 2.3 🏢 출근 후 (09:30)

| 기능 | 상세 | 데이터 소스 |
|------|------|-------------|
| 일정 브리핑 | 오늘 일정 정리 | Google Calendar, Outlook |
| 이메일 요약 | 중요 이메일 하이라이트 | Gmail, 회사 Outlook |
| 토픽 분석 | 요청시 특정 주제 리서치 | 웹 검색 + LLM 분석 |

**예시 메시지:**
```
📅 오늘 일정 브리핑

09:00 - 현재 시각
10:00 - 팀 스탠드업 (Zoom)
14:00 - AI 프로젝트 리뷰
16:00 - 1:1 미팅 (김팀장)

📧 확인 필요한 메일: 3건
- [긴급] 서버 점검 안내
- [회신요망] Q4 예산 검토
- [FYI] 신규 입사자 안내
```

### 2.4 🚶 퇴근시간 (18:00)

| 기능 | 상세 | 데이터 소스 |
|------|------|-------------|
| 저녁 일정 | 오늘 저녁/내일 주요 일정 | Google Calendar |
| 퇴근길 콘텐츠 | 읽을거리/볼거리 추천 | 웹 검색 |
| 트렌드 | 요즘 유행 영화/유튜브 | YouTube API, 영화 API |

### 2.5 🏠 저녁 (21:00)

| 기능 | 상세 | 데이터 소스 |
|------|------|-------------|
| 프로젝트 리마인드 | 진행 중인 개인 프로젝트 | Obsidian, Qdrant |
| 콘텐츠 추천 | 영화, 유튜브, 글 | 웹 검색 |
| 내일 프리뷰 | 내일 주요 일정 미리보기 | Google Calendar |

---

## 3. 기술 아키텍처

### 3.1 권장 스택

```
┌─────────────────────────────────────────────────────┐
│                    사용자 (Telegram)                  │
└─────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│              Telegram Bot (Python)                   │
│         python-telegram-bot / aiogram               │
└─────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│                n8n (자동화 엔진)                      │
│  - Cron 스케줄링 (시간대별 트리거)                    │
│  - HTTP Webhook (실시간 요청)                        │
│  - API 연동 (Calendar, Mail, News)                   │
└─────────────────────────────────────────────────────┘
                          │
          ┌───────────────┼───────────────┐
          ▼               ▼               ▼
   ┌────────────┐  ┌────────────┐  ┌────────────┐
   │ LLM API    │  │ Data APIs  │  │ Storage    │
   │ (Gemini)   │  │ Weather    │  │ Qdrant     │
   │            │  │ News       │  │ Obsidian   │
   │            │  │ Calendar   │  │            │
   └────────────┘  └────────────┘  └────────────┘
```

### 3.2 서버 비용 문제 해결 💡

**옵션 A: Oracle Cloud Free Tier (권장)**
```yaml
장점:
  - 완전 무료 (Always Free)
  - ARM A1 인스턴스 4 OCPU, 24GB RAM 제공
  - n8n, Telegram Bot 모두 구동 가능
단점:
  - 리전별 가용성 이슈 (ap-chuncheon-1 대기열)
  - 초기 세팅 필요
현황:
  - 마스터 이미 Oracle Cloud 사용 중
  - A1.Flex 인스턴스 생성 스크립트 보유
```

**옵션 B: Cloudflare Workers + KV**
```yaml
장점:
  - 무료 티어 10만 요청/일
  - 서버리스, 관리 불필요
  - 전 세계 엣지 배포
단점:
  - n8n 불가 (Workers 환경 제약)
  - 복잡한 워크플로우 한계
적합:
  - 단순 Telegram Bot만 운영시
```

**옵션 C: GitHub Actions + Gist**
```yaml
장점:
  - 완전 무료 (월 2000분)
  - 크론 스케줄링 지원
  - 코드 기반 관리
단점:
  - 최소 실행 간격 5분
  - 상태 저장 제한적
적합:
  - 시간대별 알림만 필요시
```

**옵션 D: Railway / Render Free Tier**
```yaml
장점:
  - 간편한 배포
  - 무료 티어 제공
단점:
  - 슬립 정책 (15분 비활성시)
  - 월 500시간 제한
적합:
  - 프로토타입/테스트
```

### 3.3 맥북 슬립 문제 해결

> **핵심: 맥북 의존성 제거**

클라우드에서 모든 것을 처리하므로 맥북 상태와 무관하게 동작

```
AS-IS (문제):
  맥북 → 슬립 → 서비스 중단

TO-BE (해결):
  Oracle Cloud (24/7) → Telegram Bot 상시 운영
  맥북은 개발/설정 용도만
```

### 3.4 LLM 선택

| 모델 | 비용 | 무료 티어 | 권장 용도 |
|------|------|-----------|-----------|
| **Gemini 1.5 Flash** | $0 | 15 RPM, 1500 RPD | ✅ 메인 (뉴스 요약, 분석) |
| Gemini 1.5 Pro | $0 | 2 RPM, 50 RPD | 복잡한 분석 |
| GPT-4o-mini | $0.15/1M | - | 고품질 필요시 |
| Claude Haiku | $0.25/1M | - | 대안 |

**권장: Gemini 1.5 Flash 시작, 필요시 Pro 혼용**

---

## 4. 개발 로드맵

### Phase 1: MVP (2주)
```
Week 1:
  - [ ] Telegram Bot 기본 설정
  - [ ] Oracle Cloud 인스턴스 확보
  - [ ] n8n 설치 및 기본 워크플로우

Week 2:
  - [ ] 아침 날씨 알림 구현
  - [ ] 출근길 뉴스 브리핑 구현
  - [ ] Gemini API 연동
```

### Phase 2: Core Features (3주)
```
Week 3-4:
  - [ ] Google Calendar 연동
  - [ ] Gmail 연동 (또는 Outlook)
  - [ ] 출근 후 일정 브리핑

Week 5:
  - [ ] 퇴근/저녁 알림 구현
  - [ ] Obsidian/Qdrant 연동
  - [ ] 개인 프로젝트 리마인더
```

### Phase 3: Enhancement (2주)
```
Week 6:
  - [ ] 이미지 생성 연동
  - [ ] 대화형 인터랙션 강화
  - [ ] 사용자 설정 커스터마이징

Week 7:
  - [ ] 안정화 및 최적화
  - [ ] 에러 핸들링 강화
  - [ ] 문서화
```

---

## 5. API 및 서비스 목록

### 필수 API Keys
| 서비스 | 용도 | 무료 티어 |
|--------|------|-----------|
| Telegram Bot | 메시지 전송 | 무제한 |
| Gemini API | LLM | 1500 요청/일 |
| OpenWeatherMap | 날씨 | 1000 요청/일 |
| Google Calendar | 일정 | 무제한 |

### 선택 API Keys
| 서비스 | 용도 | 비고 |
|--------|------|------|
| News API | 뉴스 검색 | 100 요청/일 무료 |
| YouTube Data API | 영상 추천 | 10000 단위/일 |
| TMDB API | 영화 정보 | 무료 |
| Flux/Nano | 이미지 생성 | 별도 확인 |

---

## 6. 리스크 및 대응

| 리스크 | 가능성 | 영향 | 대응 |
|--------|--------|------|------|
| Oracle Cloud 인스턴스 확보 실패 | 중 | 고 | GitHub Actions 대안 준비 |
| Gemini API 한도 초과 | 저 | 중 | 캐싱 + 요청 최적화 |
| n8n 복잡도 증가 | 중 | 중 | 단순 Python 스크립트 대안 |
| Calendar 권한 이슈 | 중 | 고 | OAuth 사전 테스트 |

---

## 7. 참고 자료

- [[Architecture - Proactive AI Telegram Bot]]
- [[Development Tasks - Proactive AI Telegram Bot]]
- [n8n Self-hosting Guide](https://docs.n8n.io/hosting/)
- [python-telegram-bot](https://python-telegram-bot.org/)

---
*Created: 2025-12-03*
*Status: Draft*


---

## 📝 업데이트 기록

### 2025-12-03: GitHub Actions 전환 결정

> ⚠️ **중요 변경**: Oracle Cloud → GitHub Actions

**변경 사유:**
- Oracle Cloud 인스턴스 확보 어려움 (ap-chuncheon-1 가용성 문제)

**새 아키텍처:**
- GitHub Actions Cron 스케줄링 기반
- n8n 제거 → Python 스크립트 직접 실행
- 상태 저장: GitHub Gist 활용

**상세 내용:** [[Architecture - Proactive AI Telegram Bot]]
